{% extends "base.html" %} {% block content %}
<div class="container mt-4 mb-5">
  <!-- Alerts -->
  {% if success %}
  <div class="alert alert-success d-flex align-items-center" role="alert">
    <i class="fas fa-check-circle me-2"></i> Purchase uploaded successfully!
  </div>
  {% endif %} {% if error %}
  <div class="alert alert-danger d-flex align-items-center" role="alert"><i class="fas fa-exclamation-triangle me-2"></i> {{ error }}</div>
  {% endif %}

  <form method="post" action="{% url 'add_purchase' %}">
    {% csrf_token %}

    <!-- Purchase Order Header -->
    <div class="card mb-4 shadow-sm rounded-4">
      <div class="card-header bg-primary text-white text-center">
        <h4><i class="fas fa-file-invoice me-2"></i>Purchase Order</h4>
      </div>
    </div>

    <!-- Company & Order Details -->
    <div class="card mb-4 shadow-sm rounded-4">
      <div class="card-header bg-light">
        <strong><i class="fas fa-building me-1"></i>Company & Purchase Order Details</strong>
      </div>
      <div class="card-body row g-3">
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-building me-1"></i>Company Name:</label>
          <input type="text" name="company_name" class="form-control" required />
        </div>
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-calendar-alt me-1"></i>Date:</label>
          <input type="date" name="po_date" class="form-control" required />
        </div>
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-map-marker-alt me-1"></i>Company Address:</label>
          <input type="text" name="company_address" class="form-control" required />
        </div>
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-hashtag me-1"></i>PO No.:</label>
          <input type="text" name="po_number" class="form-control" required />
        </div>
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-phone me-1"></i>Phone Number:</label>
          <input type="text" name="company_phone" class="form-control" required />
        </div>
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-user-tie me-1"></i>Supplier:</label>
          <input type="text" name="customer_number" class="form-control" required />
        </div>
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-globe me-1"></i>Website:</label>
          <input type="text" name="company_website" class="form-control" />
        </div>
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-envelope me-1"></i>Email Address:</label>
          <input type="email" name="company_email" class="form-control" required />
        </div>
      </div>
    </div>

    <!-- Vendor Information -->
    <div class="card mb-4 shadow-sm rounded-4">
      <div class="card-header bg-light">
        <strong><i class="fas fa-truck me-1"></i>Vendor Information</strong>
      </div>
      <div class="card-body row g-3">
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-user me-1"></i>Contact Name:</label>
          <input type="text" name="vendor_contact_name" class="form-control" required />
        </div>
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-building me-1"></i>Company Name:</label>
          <input type="text" name="vendor_company_name" class="form-control" required />
        </div>
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-map-marker-alt me-1"></i>Address:</label>
          <input type="text" name="vendor_address" class="form-control" required />
        </div>
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-phone me-1"></i>Phone Number:</label>
          <input type="text" name="vendor_phone" class="form-control" required />
        </div>
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-globe me-1"></i>Website:</label>
          <input type="text" name="vendor_website" class="form-control" />
        </div>
        <div class="col-md-6">
          <label class="form-label"><i class="fas fa-envelope me-1"></i>Email Address:</label>
          <input type="email" name="vendor_email" class="form-control" required />
        </div>
      </div>
    </div>

    <!-- Product Information -->
    <div class="card mb-4 shadow-sm rounded-4">
      <div class="card-header bg-light d-flex justify-content-between align-items-center">
        <strong><i class="fas fa-box me-1"></i>Product Details</strong>
        <button type="button" class="btn btn-sm btn-primary" id="addProductRow"><i class="fas fa-plus me-1"></i>Add Product</button>
      </div>
      <div class="card-body" id="productRows">
        <div class="row product-entry g-3 mb-3">
          <div class="col-md-3">
            <input type="text" name="item_number[]" class="form-control" placeholder="Item Number" required />
          </div>
          <div class="col-md-5">
            <input type="text" name="product_name[]" class="form-control" placeholder="Product Name / Description" required />
          </div>
          <div class="col-md-2">
            <input type="number" name="quantity[]" class="form-control" placeholder="Quantity" required />
          </div>
          <div class="col-md-2 d-flex align-items-center">
            <input type="number" step="0.01" name="unit_price[]" class="form-control" placeholder="Unit Price" required />
            <button type="button" class="btn btn-danger btn-sm ms-2 remove-product"><i class="fas fa-trash-alt"></i></button>
          </div>
        </div>
      </div>
    </div>

    <!-- Submit Button -->
    <div class="text-center mb-5">
      <button type="submit" class="btn btn-success px-5 py-2"><i class="fas fa-paper-plane me-1"></i>Submit Purchase Order</button>
    </div>
  </form>
</div>

<!-- Font Awesome CDN -->
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
  integrity="sha512-Po+WogGv7Xv1m5DR+VYN7blMj+DZt7hZqQhr+0P4R3+Puh5E1pYH3ur1tzOZ6N5w+n1K3Q6H4E1+GYoJ0jtkKg=="
  crossorigin="anonymous"
  referrerpolicy="no-referrer" />

<script>
  // Add new product row
  document.getElementById("addProductRow").addEventListener("click", function () {
    const container = document.getElementById("productRows");

    const newRow = document.createElement("div");
    newRow.classList.add("row", "product-entry", "g-3", "mb-3");

    newRow.innerHTML = `
        <div class="col-md-3">
            <input type="text" name="item_number[]" class="form-control" placeholder="Item Number" required>
        </div>
        <div class="col-md-5">
            <input type="text" name="product_name[]" class="form-control" placeholder="Product Name / Description" required>
        </div>
        <div class="col-md-2">
            <input type="number" name="quantity[]" class="form-control" placeholder="Quantity" required>
        </div>
        <div class="col-md-2 d-flex align-items-center">
            <input type="number" step="0.01" name="unit_price[]" class="form-control" placeholder="Unit Price" required>
            <button type="button" class="btn btn-danger btn-sm ms-2 remove-product"><i class="fas fa-trash-alt"></i></button>
        </div>
    `;

    container.appendChild(newRow);
  });

  // Remove product row
  document.addEventListener("click", function (e) {
    if (e.target.closest(".remove-product")) {
      e.target.closest(".product-entry").remove();
    }
  });
</script>
{% endblock %}
