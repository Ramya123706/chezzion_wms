{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
    <h2 class="mb-3">Create Outbound Delivery</h2>

    <form method="post">
        {% csrf_token %}

        <!-- Delivery Header -->
        <h4 class="mb-3">Delivery Header</h4>
        <div class="row">
            <div class="col-md-4 mb-3">
                <label class="form-label">Delivery Number</label>
                {{ delivery_form.dlv_no }}
            </div>
            <div class="col-md-4 mb-3">
                <label class="form-label">Sales Order</label>
                {{ delivery_form.so_no }}
            </div>
            <div class="col-md-4 mb-3">
                <label class="form-label">Warehouse</label>
                {{ delivery_form.whs_no }}
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label class="form-label">Storage Location</label>
                {{ delivery_form.str_loc }}
            </div>
            <div class="col-md-6 mb-3">
                <label class="form-label">Delivery Date</label>
                {{ delivery_form.del_date }}
            </div>
        </div>

        <div class="row">
            <div class="col-md-4 mb-3">
                <label class="form-label">Sold To</label>
                {{ delivery_form.sold_to }}
            </div>
            <div class="col-md-4 mb-3">
                <label class="form-label">Ship To</label>
                {{ delivery_form.ship_to }}
            </div>
            <div class="col-md-4 mb-3">
                <label class="form-label">Customer Reference</label>
                {{ delivery_form.cust_ref }}
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label class="form-label">Order Date</label>
                {{ delivery_form.ord_date }}
            </div>
        </div>

        <!-- Delivery Items -->
        <h4 class="mt-4">Delivery Items</h4>
        {{ item_formset.management_form }}
        <table class="table table-bordered table-sm">
            <thead class="table-light">
                <tr>
                    <th>Item No</th>
                    <th>Product</th>
                    <th>Serial No</th>
                    <th>Batch No</th>
                    <th>Qty Ordered</th>
                    <th>Qty Issued</th>
                    <th>Unit Price</th>
                    <th>Total Unit Price</th>
                    <th>Net Price</th>
                    <th>Volume/Item</th>
                    <th>Delete</th>
                </tr>
            </thead>
            <tbody>
                {% for form in item_formset %}
                <tr>
                    <td>{{ form.dlv_it_no }}</td>
                    <td>{{ form.product }}</td>
                    <td>{{ form.serial_no }}</td>
                    <td>{{ form.batch_no }}</td>
                    <td>{{ form.qty_order }}</td>
                    <td>{{ form.qty_issued }}</td>
                    <td>{{ form.unit_price }}</td>
                    <td>
                        {% if form.instance.pk %}
                            {{ form.instance.total_unit_price }}
                        {% endif %}
                    </td>
                    <td>
                        {% if form.instance.pk %}
                            {{ form.instance.net_price }}
                        {% endif %}
                    </td>
                    <td>{{ form.vol_per_item }}</td>
                    <td>{{ form.DELETE }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- Buttons -->
        <div class="mt-3">
            <button type="submit" class="btn btn-primary">Save Delivery</button>
            <a class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>
{% endblock %}
