{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <div class="col-md-6 col-sm-12 mx-auto">
        <div class="card">
            <div class="card-header">
                <h5>Chezzion WMS-Magic Box</h5>
            </div>
            <div class="card-body">
                <div class="mb-3 text-center">
                    <img src="https://chezzion.com/wp-content/themes/chezzion-2025/assets/images/logo.png" width="50" alt="SAP logo">
                </div>

                {% if success %}
                    <div class="alert alert-success">✅ Stock uploaded successfully!</div>
                {% endif %}

                {% if error %}
                    <div class="alert alert-danger">❌ {{ error }}</div>
                {% endif %}

                <form action="{% url 'batch_product' %}" method="post">
                    {% csrf_token %}

                    <div class="form-group">
                        <label><b>Warehouse</b></label>
                        <select name="whs_no" class="form-control" required>
                            <option value="">Select Warehouse</option>
                            {% for wh in warehouse %}
                                <option value="{{ wh.whs_no }}">{{ wh.whs_no }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    

                    <div class="form-group">
                    <label for="product">Product</label>
                    <select class="form-control" id="product" name="product" required>
                        <option value="">-- Select Product --</option>
                        {% for p in products %}
                            <option value="{{ p.id }}">{{ p.product_id }} - {{ p.name }}</option>
                        {% endfor %}
                    </select>
                    <small class="form-text text-muted">
                        Can't find your product?
                        <a href="{% url 'add_product' %}" class="btn btn-sm btn-link">Add New Product</a>
                    </small>
                    </div>
                    <div class="form-group">
                        <label for="description">Description</label>
                        <input type="text" class="form-control" id="description" name="description" readonly required>
                    </div>


                    <div class="form-group">
                        <label for="quantity">Quantity</label>
                        <input type="number" class="form-control" id="quantity" name="quantity" required>
                    </div>

                    <div class="form-group">
                        <label for="batch">Batch</label>
                        <input type="text" class="form-control" id="batch" name="batch" required>
                    </div>

                    <div class="form-group">
                        <label for="bin">BIN</label>
                        <input type="text" class="form-control" id="bin" name="bin" required>
                    </div>

                    <div class="form-group">
                        <label for="pallet">Pallet</label>
                        <input type="text" class="form-control" id="pallet" name="pallet" required>
                    </div>

                    <div class="form-group">
                        <label for="p_mat">P_mat</label>
                        <input type="text" class="form-control" id="p_mat" name="p_mat" required>
                    </div>

                    <div class="form-group">
                        <label for="inspection">Inspection</label>
                        <input type="text" class="form-control" id="inspection" name="inspection" required>
                    </div>
                    

                    <div class="form-group">
                        <label for="stock_type">Stock Type</label>
                        <select class="form-control" id="stock_type" name="stock_type" required>
                            <option value="">-- Select Stock Type --</option>
                            <option value="Quality">Quality</option>
                            <option value="Blocked">Blocked</option>
                            <option value="Scrapped">Scrapped</option>
                            <option value="Unrestricted">Unrestricted</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="wps">WPS</label>
                        <input type="text" class="form-control" id="wps" name="wps" required>
                    </div>

                    <div class="form-group">
                        <label for="doc_no">Doc No</label>
                        <input type="text" class="form-control" id="doc_no" name="doc_no" required>
                    </div>

                    <div class="form-group">
                        <label for="pallet_status">Pallet Status</label>
                        <select class="form-control" id="pallet_status" name="pallet_status" required>
                            <option value="">-- Select Pallet Status --</option>
                            <option value="Received">Received</option>
                            <option value="Planned">Planned</option>
                            <option value="Damaged">Damaged</option>
                            <option value="Rejected">Rejected</option>
                        </select>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a class="btn btn-secondary" href="#">F1 ADIT</a>
                        <a class="btn btn-secondary" href="#">F1 SKUP</a>
                        <a class="btn btn-secondary" href="#">F7 BACK</a>
                        <button type="submit" class="btn btn-primary">ENTER</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script>
document.getElementById('product').addEventListener('change', function () {
    const productId = this.value;

    if (productId) {
        fetch(`/get-product-description/${productId}/`)
            .then(response => response.json())
            .then(data => {
                document.getElementById('description').value = data.description || '';
            })
            .catch(error => {
                console.error('Error fetching description:', error);
            });
    } else {
        document.getElementById('description').value = '';
    }
});
</script>

{% endblock %}
