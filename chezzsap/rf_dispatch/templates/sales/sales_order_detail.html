{% extends "base.html" %} {% block content %}
<div class="container mt-5">
  <div class="col-md-10 col-sm-12 mx-auto">
    <div class="card shadow-lg rounded-4 border-0">
      <!-- Header -->
      <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center rounded-top-4">
        <h3 class="mb-0"><i class="fas fa-file-invoice"></i> Sales Order Detail</h3>
        <a href="{% url 'sales_order_list' %}" class="btn btn-light btn-sm"> <i class="fas fa-arrow-left"></i> Back to List </a>
      </div>

      <div class="card-body">
        <!-- Sales Order Info -->
        <h5 class="text-primary mb-3"><i class="fas fa-info-circle"></i> Order Information</h5>
        <table class="table table-bordered table-sm">
          <tr>
            <th><i class="fas fa-hashtag"></i> SO No.</th>
            <td>{{ sales_order.so_no }}</td>
          </tr>
          <tr>
            <th><i class="fas fa-warehouse"></i> Warehouse</th>
            <td>
              <ul class="list-group list-group-flush">
                <li class="list-group-item">
                  <i class="fas fa-building"></i> <strong>Name:</strong> {{ sales_order.whs_no.whs_name }} ({{ sales_order.whs_no.whs_no }})
                </li>
                <li class="list-group-item"><i class="fas fa-map-marker-alt"></i> <strong>Address:</strong> {{ sales_order.whs_no.address }}</li>
                <li class="list-group-item"><i class="fas fa-phone"></i> <strong>Phone:</strong> {{ sales_order.whs_no.phn_no }}</li>
                <li class="list-group-item"><i class="fas fa-envelope"></i> <strong>Email:</strong> {{ sales_order.whs_no.email }}</li>
              </ul>
            </td>
          </tr>
          <tr>
            <th><i class="fas fa-calendar-alt"></i> Order Date</th>
            <td>{{ sales_order.order_date }}</td>
          </tr>
          <tr>
            <th><i class="fas fa-truck"></i> Delivery Date</th>
            <td>{{ sales_order.delivery_date }}</td>
          </tr>
          <tr>
            <th><i class="fas fa-clipboard-check"></i> Status</th>
            <td>
              {% if sales_order.status == "Draft" %}
              <span class="badge bg-secondary"><i class="fas fa-pencil-alt"></i> {{ sales_order.status }}</span>
              {% elif sales_order.status == "Open" %}
              <span class="badge bg-success"><i class="fas fa-play"></i> {{ sales_order.status }}</span>
              {% elif sales_order.status == "Cancel" %}
              <span class="badge bg-danger"><i class="fas fa-times"></i> {{ sales_order.status }}</span>
              {% elif sales_order.status == "Confirmed" %}
              <span class="badge bg-primary"><i class="fas fa-check-circle"></i> {{ sales_order.status }}</span>
              {% else %}
              <span class="badge bg-info"><i class="fas fa-info-circle"></i> {{ sales_order.status }}</span>
              {% endif %}
            </td>
          </tr>
        </table>

        <!-- Customer Details -->
        <h5 class="text-primary mt-4"><i class="fas fa-user"></i> Customer Details</h5>
        <table class="table table-bordered table-sm">
          <tr>
            <th><i class="fas fa-id-card"></i> Customer ID</th>
            <td>{{ sales_order.customer_id }}</td>
          </tr>
          <tr>
            <th><i class="fas fa-user-tag"></i> Customer Code</th>
            <td>{{ sales_order.customer_code }}</td>
          </tr>
        </table>

        <!-- Product Details -->
        <h5 class="text-primary mt-4"><i class="fas fa-boxes"></i> Product Details</h5>
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle text-center">
            <thead class="table-dark">
              <tr>
                <th><i class="fas fa-barcode"></i> Product ID</th>
                <th><i class="fas fa-box"></i> Product Name</th>
                <th><i class="fas fa-cubes"></i> Existing Quantity</th>
                <th><i class="fas fa-plus-square"></i> Ordered Quantity</th>
                <th><i class="fas fa-dollar-sign"></i> Unit Price</th>
                <th><i class="fas fa-calculator"></i> Total Price</th>
              </tr>
            </thead>
            <tbody>
              {% for item in so_items %}
              <tr>
                <td>{{ item.product_id }}</td>
                <td>{{ item.product_name }}</td>
                <td>{{ item.existing_quantity }}</td>
                <td>{{ item.quantity }}</td>
                <td>{{ item.unit_price }}</td>
                <td>{{ item.unit_total_price }}</td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="6" class="text-center text-muted">No products in this order</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>

        <!-- Totals -->
        <h5 class="text-primary mt-4"><i class="fas fa-receipt"></i> Summary</h5>
        <table class="table table-bordered table-sm">
          <tr>
            <th><i class="fas fa-coins"></i> Net Total Price</th>
            <td>{{ sales_order.net_total_price|floatformat:2 }}</td>
          </tr>
          <tr>
            <th><i class="fas fa-comment-dots"></i> Remarks</th>
            <td>{{ sales_order.remarks|default:"-" }}</td>
          </tr>
        </table>

        <!-- Actions -->
        <div class="d-flex justify-content-end gap-2 mt-4">
          <a href="{% url 'sales_order_edit' sales_order.so_no %}" class="btn btn-warning"> <i class="fas fa-edit"></i> Edit </a>
          <a
            href="{% url 'sales_order_delete' sales_order.so_no %}"
            class="btn btn-danger"
            onclick="return confirm('Are you sure you want to delete this order?');">
            <i class="fas fa-trash"></i> Delete
          </a>
          <a href="{% url 'sales_order_pdf' sales_order.so_no %}" class="btn btn-success"> <i class="fas fa-file-pdf"></i> Download PDF </a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
